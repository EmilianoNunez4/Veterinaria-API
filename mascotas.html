<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mis Mascotas - Veterinaria</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="mascotas.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
      <nav>
        <div class="logo">
          <img src="src/logovet-Photoroom.png" alt="logo-empresa" class="logimg">
          <span class="logo-text" style="font-weight: bold;">Veterinaria San Jorge</span>
        </div>
        <ul>
          <li><a href="index.html">Inicio</a></li>
          <li><a href="mascotas.html">Mascotas</a></li>
          <li><a href="#turnos">Turnos</a></li>
          <li><a href="#servicios">Servicios</a></li>
          <li><a href="login.html" onclick="cerrarSesion()">Salir</a></li>
        </ul>
      </nav>
    </header>

    <section class="hero-hero mascotas-hero">
      <div class="hero-bg hero-bg-1"></div>
      <div class="hero-bg hero-bg-2"></div>
      <div class="hero-overlay"></div>

      <div class="hero-content fadeUp">
        <h1 class="hero-title">GESTION DE MASCOTAS</h1>
        <p class="hero-sub">Aquí podrás agregar y gestionar tus <strong>Mascotas</strong></p>
        <p class="hero-lead">
          Crea sus perfiles, organiza sus turnos y lleva un control de cuidados de forma simple y rápida.
        </p>
        <div class="hero-ctas">
          <a class="btn btn-primary" href="#mascotasGrid">Ver Mis Mascotas</a>
          <a class="btn btn-outline" id="agregarMascotaBtn">Agregar Mascota</a>
        </div>
      </div>
    </section>
    <script>
    // Hero dinámico en mascotas
    document.addEventListener('DOMContentLoaded', () => {
      const bg1 = document.querySelector('.mascotas-hero .hero-bg-1');
      const bg2 = document.querySelector('.mascotas-hero .hero-bg-2');

      if (bg1 && bg2) {
        const imagenes = [
          "https://images.unsplash.com/photo-1596272875729-ed2ff7d6d9c5?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
          "https://images.unsplash.com/photo-1577175889968-f551f5944abd?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
        ];
        let idx = 0;
        let mostrandoPrimera = true;

        bg1.style.backgroundImage = `url('${imagenes[0]}')`;
        bg2.style.backgroundImage = `url('${imagenes[1]}')`;

        setInterval(() => {
          idx = (idx + 1) % imagenes.length;
          if (mostrandoPrimera) {
            bg2.style.backgroundImage = `url('${imagenes[idx]}')`;
            bg2.style.opacity = 1;
            bg1.style.opacity = 0;
          } else {
            bg1.style.backgroundImage = `url('${imagenes[idx]}')`;
            bg1.style.opacity = 1;
            bg2.style.opacity = 0;
          }
          mostrandoPrimera = !mostrandoPrimera;
        }, 8000);
      }
    });
    </script>

    <main class="mascotas-dashboard">
      <div class="mascotas-header">
        <h1 style="font-weight: 600;">Mis Mascotas</h1>
        <button class="btn-primary" id="agregarMascotaBtn"><i class="fas fa-plus"></i> Agregar Mascota</button>
      </div>

      <div class="mascotas-grid" id="mascotasGrid"></div>

      <div class="mascotas-vacio" id="mascotasVacio" style="display: none;">
          <div class="vacio-icono">
              <i class="fas fa-paw"></i>
          </div>
          <h2>Aún no tienes mascotas registradas</h2>
          <p>¡Agrega a tu primer compañero para empezar a gestionar sus turnos y cuidados!</p>
          <button class="btn-primary" id="agregarMascotaBtn2">Agregar la primera Mascota</button>
      </div>
    </main>

    <!-- MODAL AGREGAR/EDITAR MASCOTA -->
    <div class="mascota-modal-bg" id="mascotaModalBg">
      <div class="mascota-modal">
        <button class="close-modal" id="cerrarModalBtn" title="Cerrar">&times;</button>
        <h2 id="modalTitulo">Agregar Nueva Mascota</h2>
        <form class="mascota-form" id="mascotaForm">
          <input type="hidden" id="mascotaId" name="mascotaId">

          <div>
              <label for="nombreMascota">Nombre de la Mascota</label>
              <input type="text" id="nombreMascota" name="nombre" required maxlength="30" placeholder="Ej: Firulais">
          </div>

          <div>
              <label for="especieMascota">Especie</label>
              <input type="text" id="especieMascota" name="especie" required maxlength="30" placeholder="Ej: Perro">
          </div>

          <div>
              <label for="descripcionMascota">Descripción</label>
              <input type="text" id="descripcionMascota" name="descripcion" maxlength="80" placeholder="Ej: Juguetón, buen compañero...">
          </div>

          <div>
              <label for="fotoMascota">Foto (URL)</label>
              <input type="url" id="fotoMascota" name="foto" maxlength="300" placeholder="http://...">
          </div>

          <div class="form-actions">
            <button type="button" class="btn-outline" id="cancelarBtn">Cancelar</button>
            <button type="submit" class="btn-primary" id="guardarBtn">Guardar Mascota</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL SOLO PARA CAMBIAR LA FOTO -->
    <div class="mascota-modal-bg" id="modalFotoBg">
      <div class="mascota-modal">
        <button class="close-modal" id="cerrarModalFotoBtn" title="Cerrar">&times;</button>
        <h2>Cambiar foto</h2>
        <form class="solo-foto-form" id="soloFotoForm">
          <label for="nuevaFotoMascota">Nueva URL de la foto</label>
          <input type="url" id="nuevaFotoMascota" name="nuevaFotoMascota" placeholder="http://..." required>
          <div class="solo-foto-actions">
            <button type="button" class="btn-outline" id="cancelarFotoBtn">Cancelar</button>
            <button type="submit" class="btn-primary" id="guardarFotoBtn">Guardar</button>
          </div>
        </form>
      </div>
    </div>

    <article class="barra1"></article>

    <footer class="footer-vet">
      <div class="footer-main">
        <div class="footer-brand">
          <span class="footer-logo"></span>
          <span class="footer-title">Veterinaria <br>San Jorge</span>
        </div>
        <div class="footer-col">
          <h3>Nosotros</h3>
          <p>Tu veterinaria de confianza.<br>Atención cálida y personalizada.<br>Experiencia y profesionalismo.<br>¡Gracias por confiar en nosotros!</p>
        </div>
        <div class="footer-col">
          <h3>Términos y Condiciones</h3>
          <ul>
            <li><a href="#">Política de privacidad</a></li>
            <li><a href="#">Uso del sitio</a></li>
            <li><a href="#">Turnos y servicios</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h3>Contacto</h3>
          <ul>
            <li><span class="footer-icon"><svg width="18" height="18" fill="#ffffff" viewBox="0 0 24 24"><path d="M6.62 10.79a15.053 15.053 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.21c1.21.49 2.53.76 3.88.76a1 1 0 011 1V20a1 1 0 01-1 1C11.28 21 3 12.72 3 3a1 1 0 011-1h3.5a1 1 0 011 1c0 1.35.27 2.67.76 3.88a1 1 0 01-.21 1.11l-2.2 2.2z"/></svg></span> +54 11 1234-5678</li>
            <li><span class="footer-icon"><svg width="18" height="18" fill="#ffffff" viewBox="0 0 24 24"><path d="M21 6.5v11a2 2 0 01-2 2H5a2 2 0 01-2-2v-11a2 2 0 012-2h14a2 2 0 012 2zm-2 0H5v.01l8 5.33a2 2 0 002 0l8-5.33V6.5z"/></svg></span> info@veterinaria.com</li>
            <li><span class="footer-icon"><svg width="18" height="18" fill="#ffffff" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"/></svg></span> Av. Principal 1234, Buenos Aires</li>
          </ul>
        </div>
      </div>
      <div class="footer-copy">© 2025 Veterinaria. Todos los derechos reservados.</div>
    </footer>

    <script>
    // =========================
    // MOCK Y FUNCIONALIDAD DE CARDS MASCOTAS
    // =========================
    let mascotas = [
      { id: 1, nombre: "Firulais", especie: "Perro Mestizo", descripcion: "Muy juguetón y cariñoso.", foto: "" },
      { id: 2, nombre: "Mishifu", especie: "Gato Siamés", descripcion: "Le encanta dormir al sol.", foto: "" },
      { id: 3, nombre: "Paco", especie: "Loro", descripcion: "Habla y repite frases.", foto: "" },
      { id: 4, nombre: "Rocky", especie: "Golden Retriever", descripcion: "Fiel y leal, adora los paseos.", foto: "" }
    ];
    let editIndex = null;
    let editFotoIndex = null;

    function renderMascotas() {
      const grid = document.getElementById('mascotasGrid');
      const vacio = document.getElementById('mascotasVacio');
      grid.innerHTML = '';

      if (!mascotas.length) {
        vacio.style.display = 'flex';
        grid.style.display = 'none';
      } else {
        vacio.style.display = 'none';
        grid.style.display = 'grid';
        mascotas.forEach((m, i) => {
          // Card diseño tipo "profile card moderna", sin estrellas, con descripción y foto editable
          const card = document.createElement('article');
          card.className = 'mascota-card';
          card.innerHTML = `
            <div class="card-header" style="flex-direction:column;align-items:center;gap:12px;margin-bottom:18px;">
              <div style="position:relative;">
                <img src="${m.foto ? m.foto : 'https://cdn-icons-png.flaticon.com/512/616/616408.png'}" alt="${m.nombre}" class="mascota-icono" style="width:80px;height:80px;border-radius:50%;background:#f5f5f5;border:3px solid #fff;box-shadow:0 2px 10px #0001;">
                <button class="cambiar-foto-btn" style="position:absolute;right:-8px;bottom:0;background:#fff5f5;color:#2378ff;border:1px solid #2378ff;font-size:0.85em; border-radius:8px;padding:3px 10px;cursor:pointer;font-weight:700;z-index:2;" onclick="cambiarFotoMascota(${i});event.stopPropagation();" title="Cambiar foto">
                  <i class="fas fa-camera"></i>
                </button>
              </div>
              <div class="card-titulo" style="text-align:center;">
                <h2>${m.nombre}</h2>
                <p>${m.especie}</p>
              </div>
            </div>
            <div class="card-body" style="text-align:center;">
              <p style="color:#6d7a8a;min-height:36px;">${m.descripcion ? m.descripcion : ''}</p>
            </div>
            <div class="card-actions" style="justify-content:center;">
              <button class="btn-icon btn-edit" onclick="editarMascota(${i})" title="Editar"><i class="fas fa-pencil-alt"></i></button>
              <button class="btn-icon btn-delete" onclick="eliminarMascota(${i})" title="Eliminar"><i class="fas fa-trash-alt"></i></button>
            </div>
          `;
          grid.appendChild(card);
        });
      }
    }

    // Modal de mascota completa
    function abrirModalMascota(mascota = null, index = null) {
      document.getElementById('mascotaModalBg').classList.add('activo');
      document.getElementById('modalTitulo').innerText = mascota ? 'Editar Mascota' : 'Agregar Nueva Mascota';
      document.getElementById('mascotaForm').reset();
      document.getElementById('mascotaId').value = '';
      editIndex = index;
      if (mascota) {
        document.getElementById('mascotaId').value = mascota.id;
        document.getElementById('nombreMascota').value = mascota.nombre || '';
        document.getElementById('especieMascota').value = mascota.especie || '';
        document.getElementById('descripcionMascota').value = mascota.descripcion || '';
        document.getElementById('fotoMascota').value = mascota.foto || '';
      }
    }
    function cerrarModalMascota() {
      document.getElementById('mascotaModalBg').classList.remove('activo');
      editIndex = null;
    }

    // Modal solo cambiar foto
    function cambiarFotoMascota(idx) {
      editFotoIndex = idx;
      document.getElementById('nuevaFotoMascota').value = mascotas[idx].foto || '';
      document.getElementById('modalFotoBg').classList.add('activo');
      setTimeout(() => document.getElementById('nuevaFotoMascota').focus(), 120);
    }
    function cerrarModalFoto() {
      document.getElementById('modalFotoBg').classList.remove('activo');
      editFotoIndex = null;
    }

    // Eventos de modales y botones agregar
    document.addEventListener('DOMContentLoaded', () => {
      renderMascotas();

      // Selecciona TODOS los botones de agregar
      document.querySelectorAll('#agregarMascotaBtn').forEach(btn => {
        btn.addEventListener('click', () => abrirModalMascota());
      });
      // El de la sección vacía
      const btn2 = document.getElementById('agregarMascotaBtn2');
      if (btn2) btn2.addEventListener('click', () => abrirModalMascota());

      const modalBg = document.getElementById('mascotaModalBg');
      const form = document.getElementById('mascotaForm');
      const modalFotoBg = document.getElementById('modalFotoBg');
      const soloFotoForm = document.getElementById('soloFotoForm');

      const cerrarModal = () => cerrarModalMascota();

      document.getElementById('cerrarModalBtn').addEventListener('click', cerrarModal);
      document.getElementById('cancelarBtn').addEventListener('click', cerrarModal);
      modalBg.addEventListener('click', (e) => {
        if (e.target === modalBg) cerrarModal();
      });

      document.getElementById('cerrarModalFotoBtn').onclick = cerrarModalFoto;
      document.getElementById('cancelarFotoBtn').onclick = cerrarModalFoto;
      modalFotoBg.addEventListener('click', (e) => {
        if (e.target === modalFotoBg) cerrarModalFoto();
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const id = document.getElementById('mascotaId').value;
        const nombre = document.getElementById('nombreMascota').value.trim();
        const especie = document.getElementById('especieMascota').value.trim();
        const descripcion = document.getElementById('descripcionMascota').value.trim();
        const foto = document.getElementById('fotoMascota').value.trim();

        if (id) { // Editar
          const idx = mascotas.findIndex(m => m.id == id);
          if (idx !== -1) {
            mascotas[idx] = { ...mascotas[idx], nombre, especie, descripcion, foto };
          }
        } else { // Nueva
          const newId = mascotas.length ? mascotas[mascotas.length-1].id + 1 : 1;
          mascotas.push({ id: newId, nombre, especie, descripcion, foto });
        }
        cerrarModalMascota();
        renderMascotas();
      });

      soloFotoForm.onsubmit = function(e){
        e.preventDefault();
        const url = document.getElementById('nuevaFotoMascota').value.trim();
        if(editFotoIndex!==null) {
          mascotas[editFotoIndex].foto = url;
          renderMascotas();
        }
        cerrarModalFoto();
      };
    });

    window.editarMascota = function(idx) {
      abrirModalMascota(mascotas[idx], idx);
    };
    window.eliminarMascota = function(idx) {
      if(confirm('¿Seguro que querés eliminar esta mascota?')){
        mascotas.splice(idx, 1);
        renderMascotas();
      }
    };
    window.cambiarFotoMascota = cambiarFotoMascota;

    function cerrarSesion() {
        localStorage.removeItem("token");
        window.location.href = "login.html";
    }
    </script>
</body>
</html>